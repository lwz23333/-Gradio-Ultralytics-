<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="860" viewBox="0 0 1280 860" font-family="Segoe UI,Roboto,Helvetica,Arial,sans-serif">
  <defs>
    <style>
      .title{font-size:28px;font-weight:bold;}
      .group{fill:#f7f9fc;stroke:#aeb8c2;stroke-width:2;}
      .box{fill:#ffffff;stroke:#6b7280;stroke-width:1.5;rx:8;}
      .label{font-size:14px;fill:#111827;}
      .sub{font-size:12px;fill:#374151;}
      .arrow{stroke:#6b7280;stroke-width:2;marker-end:url(#arrowHead);} 
      .tag{fill:#eef2ff;stroke:#6366f1;stroke-width:1;rx:6;}
      .tagtext{font-size:12px;fill:#3730a3;}
    </style>
    <marker id="arrowHead" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 z" fill="#6b7280" />
    </marker>
  </defs>

  <text x="40" y="50" class="title">Gradio + Ultralytics YOLO 在线视频推理系统 - 架构图</text>

  <!-- Groups -->
  <rect x="40" y="80" width="360" height="300" class="group"/>
  <text x="55" y="105" class="label">客户端（浏览器）</text>

  <rect x="430" y="80" width="380" height="300" class="group"/>
  <text x="445" y="105" class="label">本地应用（Python）</text>

  <rect x="830" y="80" width="410" height="300" class="group"/>
  <text x="845" y="105" class="label">推理与处理</text>

  <rect x="40" y="410" width="520" height="330" class="group"/>
  <text x="55" y="435" class="label">视频源</text>

  <rect x="590" y="410" width="650" height="330" class="group"/>
  <text x="605" y="435" class="label">输出与落地</text>

  <!-- Client boxes -->
  <rect x="70" y="130" width="300" height="60" class="box"/>
  <text x="85" y="160" class="label">Gradio 前端 UI（Blocks/Components）</text>
  <text x="85" y="182" class="sub">参数表单 / 结果显示 / 事件绑定</text>

  <rect x="70" y="210" width="140" height="50" class="box"/>
  <text x="90" y="240" class="label">开始推理</text>

  <rect x="230" y="210" width="140" height="50" class="box"/>
  <text x="250" y="240" class="label">停止推理</text>

  <rect x="70" y="280" width="300" height="80" class="box"/>
  <text x="85" y="310" class="label">结果展示 gr.Image / 参数展示 gr.JSON</text>

  <!-- App boxes -->
  <rect x="460" y="130" width="320" height="60" class="box"/>
  <text x="475" y="160" class="label">interface.py（页面布局 / 事件链）</text>
  <text x="475" y="182" class="sub">start.then(video_inference) / stop.cancels</text>

  <rect x="460" y="210" width="320" height="60" class="box"/>
  <text x="475" y="240" class="label">action_function.py（核心逻辑）</text>
  <text x="475" y="262" class="sub">show_params / video_inference / 源解析</text>

  <rect x="460" y="290" width="150" height="50" class="box"/>
  <text x="480" y="320" class="label">run.py（启动）</text>

  <rect x="630" y="290" width="150" height="50" class="box"/>
  <text x="645" y="320" class="label">style（主题/CSS/JS）</text>

  <!-- Inference boxes -->
  <rect x="860" y="130" width="360" height="70" class="box"/>
  <text x="875" y="160" class="label">Ultralytics YOLO (v11n/s/m/l)</text>
  <text x="875" y="182" class="sub">模型加载 / 设备选择（cpu/cuda）/ imgsz</text>

  <rect x="860" y="220" width="170" height="60" class="box"/>
  <text x="875" y="250" class="label">OpenCV 解码/缩放</text>

  <rect x="1050" y="220" width="170" height="60" class="box"/>
  <text x="1065" y="250" class="label">类别解析（全部/指定）</text>

  <rect x="860" y="290" width="360" height="50" class="box"/>
  <text x="875" y="320" class="label">性能优化：imgsz、智能缩放、可选帧抽样</text>

  <!-- Sources -->
  <rect x="70" y="460" width="230" height="70" class="box"/>
  <text x="85" y="490" class="label">本地文件（gr.File）</text>
  <text x="85" y="512" class="sub">路径/对象/字典 统一解析</text>

  <rect x="320" y="460" width="220" height="70" class="box"/>
  <text x="335" y="490" class="label">摄像头（设备ID）</text>
  <text x="335" y="512" class="sub">0/1/…</text>

  <rect x="70" y="550" width="470" height="70" class="box"/>
  <text x="85" y="580" class="label">网络流（RTSP / RTMP / HLS[m3u8] / HTTP）</text>

  <!-- Outputs -->
  <rect x="620" y="460" width="290" height="70" class="box"/>
  <text x="635" y="490" class="label">流式输出（yield -> gr.Image）</text>

  <rect x="930" y="460" width="290" height="70" class="box"/>
  <text x="945" y="490" class="label">可选保存 ./runs/detect/predict</text>

  <rect x="620" y="550" width="290" height="70" class="box"/>
  <text x="635" y="580" class="label">日志/状态 gr.Info/Warning/Error</text>

  <rect x="930" y="550" width="290" height="70" class="box"/>
  <text x="945" y="580" class="label">本地 tmp（项目内）</text>

  <!-- Arrows -->
  <line x1="370" y1="160" x2="460" y2="160" class="arrow"/>
  <line x1="370" y1="235" x2="460" y2="235" class="arrow"/>
  <line x1="370" y1="315" x2="460" y2="235" class="arrow"/>

  <line x1="620" y1="240" x2="860" y2="165" class="arrow"/>
  <line x1="620" y1="240" x2="860" y2="255" class="arrow"/>
  <line x1="620" y1="240" x2="860" y2="315" class="arrow"/>

  <line x1="310" y1="495" x2="460" y2="240" class="arrow"/>
  <line x1="540" y1="495" x2="460" y2="240" class="arrow"/>
  <line x1="310" y1="585" x2="460" y2="240" class="arrow"/>

  <line x1="1040" y1="165" x2="1060" y2="255" class="arrow"/>
  <line x1="930" y1="255" x2="1040" y2="255" class="arrow"/>

  <line x1="1040" y1="165" x2="765" y2="495" class="arrow"/>
  <line x1="1040" y1="165" x2="1075" y2="495" class="arrow"/>

  <!-- Tags -->
  <rect x="860" y="355" width="150" height="24" class="tag"/>
  <text x="870" y="371" class="tagtext">device: auto / cpu / cuda:0</text>
  <rect x="1030" y="355" width="190" height="24" class="tag"/>
  <text x="1040" y="371" class="tagtext">classes: 空=全部 / 0,2,5=指定</text>

</svg>
